<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Fake SIS Data Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Faker (browser/UMD build) -->
  <script src="https://cdn.jsdelivr.net/npm/@faker-js/faker@9.0.0/dist/faker.umd.min.js"></script>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; padding: 2rem; line-height: 1.4; }
    .grid { display: grid; gap: 1rem; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); max-width: 960px; }
    .card { border: 1px solid #e5e7eb; border-radius: 12px; padding: 1rem; }
    label { display: flex; justify-content: space-between; align-items: center; gap: 1rem; }
    input { width: 90px; padding: .4rem .5rem; }
    button { padding: .7rem 1rem; border: 0; border-radius: 10px; cursor: pointer; font-weight: 600; }
    .primary { background: #111827; color: white; }
    .muted { color: #6b7280; }
    .row { display: flex; gap: .75rem; flex-wrap: wrap; }
    .log { margin-top: 1rem; font-family: ui-monospace, SFMono-Regular, Menlo, monospace; white-space: pre-wrap; background: #f9fafb; border: 1px dashed #e5e7eb; padding: .75rem; border-radius: 8px; }
  </style>
</head>
<body>
  <h1>Fake Clever-Style SIS Data (CSV)</h1>
  <p class="muted">Generates randomized but structured CSVs for schools, students, teachers, and staffâ€”fully in your browser.</p>

  <div class="grid">
    <div class="card">
      <h3>Configuration</h3>
      <label>School ID <input id="schoolId" type="text" value="1" /></label>
      <label>Students <input id="studentsCount" type="number" value="25" min="1" /></label>
      <label>Teachers <input id="teachersCount" type="number" value="10" min="1" /></label>
      <label>Staff <input id="staffCount" type="number" value="5" min="1" /></label>
      <div class="row">
        <button id="generate" class="primary">Generate CSVs</button>
        <button id="trySample">Try 5 / 2 / 1</button>
      </div>
    </div>

    <div class="card">
      <h3>What it does</h3>
      <ul>
        <li>IDs are <strong>unique each run</strong> (random 6-digit component).</li>
        <li>Emails use <code>firstname.lastname@login.exampledistrict.com</code>.</li>
        <li>Passwords follow: <code>{id}{FirstName}</code> (e.g., <code>1_STU_123456_1Sydnee</code>).</li>
        <li>Downloads: <code>schools.csv</code>, <code>students.csv</code>, <code>teachers.csv</code>, <code>staff.csv</code>.</li>
      </ul>
    </div>
  </div>

  <div id="log" class="log" aria-live="polite"></div>

  <script>
  const faker = window.faker;

    // --- Helpers ---
    const pad = n => String(n).padStart(2, '0');

    function birthdateISO({ minAge = 5, maxAge = 18 }) {
      const now = new Date();
      const year = now.getFullYear() - (minAge + Math.floor(Math.random() * (maxAge - minAge + 1)));
      const month = Math.floor(Math.random() * 12);
      const day = Math.min(28, Math.floor(Math.random() * 28) + 1);
      return `${year}-${pad(month + 1)}-${pad(day)}`;
    }

    function generateRandomId(schoolId, prefix, index) {
      const randomComponent = Math.floor(100000 + Math.random() * 900000); // 6-digit
      return `${schoolId}_${prefix}_${randomComponent}_${index + 1}`;
    }

    function generateEmail(firstName, lastName) {
      return `${firstName}.${lastName}@login.exampledistrict.com`
        .toLowerCase()
        .replace(/\s+/g, '')
        .replace(/[^a-z0-9.@]/g, '');
    }

    function toCSV(rows) {
      if (!rows.length) return '';
      const headers = Object.keys(rows[0]);
      const esc = v => {
        if (v === null || v === undefined) return '';
        const s = String(v);
        return /[",\n]/.test(s) ? `"${s.replace(/"/g, '""')}"` : s;
      };
      const lines = [headers.join(',')];
      for (const row of rows) {
        lines.push(headers.map(h => esc(row[h])).join(','));
      }
      return lines.join('\n');
    }

    function download(filename, text) {
      const blob = new Blob([text], { type: 'text/csv;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    function log(msg) {
      const el = document.getElementById('log');
      el.textContent += (el.textContent ? '\n' : '') + msg;
    }

    // --- Generators ---
    function generateSchool({ schoolId }) {
      return [{
        School_id: schoolId,
        School_name: 'North High School',
        State_id: faker.number.int({ min: 100000, max: 999999 }),
        School_address: faker.location.streetAddress(),
        School_city: faker.location.city(),
        School_state: 'CA',
        School_zip: faker.location.zipCode(),
        School_phone: faker.phone.number(),
        Low_grade: '9',
        High_grade: '12',
        Principal: faker.person.fullName(),
        Principal_email: generateEmail(faker.person.firstName(), faker.person.lastName()),
      }];
    }

    function generateStudents({ schoolId, count }) {
      return Array.from({ length: count }, (_, i) => {
        const first = faker.person.firstName();
        const last = faker.person.lastName();
        const id = generateRandomId(schoolId, 'STU', i);
        const password = `${id}${first}`;
        return {
          School_id: schoolId,
          Student_id: id,
          Student_number: faker.number.int({ min: 100000, max: 999999 }),
          State_id: faker.number.int({ min: 100000, max: 999999 }),
          Last_name: last,
          First_name: first,
          Middle_name: faker.person.middleName(),
          Gender: faker.helpers.arrayElement(['M', 'F', 'X']),
          Dob: birthdateISO({ minAge: 5, maxAge: 18 }),
          Grade: faker.number.int({ min: 9, max: 12 }),
          Student_email: generateEmail(first, last),
          Contact_name: faker.person.fullName(),
          Contact_type: faker.helpers.arrayElement(['Parent', 'Guardian', 'Sibling']),
          Contact_phone: faker.phone.number(),
          Contact_email: generateEmail(faker.person.firstName(), faker.person.lastName()),
          Username: generateEmail(first, last),
          Password: password,
        };
      });
    }

    function generateTeachers({ schoolId, count }) {
      return Array.from({ length: count }, (_, i) => {
        const first = faker.person.firstName();
        const last = faker.person.lastName();
        const id = generateRandomId(schoolId, 'TCH', i);
        const password = `${id}${first}`;
        return {
          School_id: schoolId,
          Teacher_id: id,
          Teacher_number: faker.number.int({ min: 200000, max: 299999 }),
          State_teacher_id: faker.number.int({ min: 100000, max: 999999 }),
          Last_name: last,
          First_name: first,
          Middle_name: faker.person.middleName(),
          Title: faker.helpers.arrayElement(['Math Teacher', 'Science Teacher', 'History Teacher']),
          Teacher_email: generateEmail(first, last),
          Username: generateEmail(first, last),
          Password: password,
        };
      });
    }

    function generateStaff({ schoolId, count }) {
      return Array.from({ length: count }, (_, i) => {
        const first = faker.person.firstName();
        const last = faker.person.lastName();
        const id = generateRandomId(schoolId, 'STF', i);
        const password = `${id}${first}`;
        return {
          School_id: schoolId,
          Staff_id: id,
          Staff_email: generateEmail(first, last),
          First_name: first,
          Last_name: last,
          Title: faker.helpers.arrayElement(['Principal', 'Counselor', 'Librarian']),
          Username: generateEmail(first, last),
          Password: password,
        };
      });
    }

    // --- Wire up UI ---
    document.getElementById('trySample').addEventListener('click', () => {
      document.getElementById('studentsCount').value = 5;
      document.getElementById('teachersCount').value = 2;
      document.getElementById('staffCount').value = 1;
    });

    document.getElementById('generate').addEventListener('click', () => {
      const schoolId = document.getElementById('schoolId').value || '1';
      const studentsCount = parseInt(document.getElementById('studentsCount').value || '25', 10);
      const teachersCount = parseInt(document.getElementById('teachersCount').value || '10', 10);
      const staffCount = parseInt(document.getElementById('staffCount').value || '5', 10);

      // Build data
      const schools = generateSchool({ schoolId });
      const students = generateStudents({ schoolId, count: studentsCount });
      const teachers = generateTeachers({ schoolId, count: teachersCount });
      const staff = generateStaff({ schoolId, count: staffCount });

      // CSVs
      const schoolsCSV = toCSV(schools);
      const studentsCSV = toCSV(students);
      const teachersCSV = toCSV(teachers);
      const staffCSV = toCSV(staff);

      // Downloads
      download('schools.csv', schoolsCSV);
      download('students.csv', studentsCSV);
      download('teachers.csv', teachersCSV);
      download('staff.csv', staffCSV);

      // Log sample IDs
      const sample = [
        `Student: ${students[0]?.Student_id}`,
        `Teacher: ${teachers[0]?.Teacher_id}`,
        `Staff:   ${staff[0]?.Staff_id}`,
      ].filter(Boolean).join('\n');

      document.getElementById('log').textContent = ''; // clear
      log('Data generation complete! ðŸŽ‰');
      log('New unique IDs are created every run.');
      if (sample) log('Sample IDs from this run:\n' + sample);
    });
  </script>
</body>
</html>
